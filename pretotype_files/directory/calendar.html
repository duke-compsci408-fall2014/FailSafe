<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8' />
		<!-- Bootstrap -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
		<link rel="stylesheet" href="style.css">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="script.js"></script>
		<!-- JQuery -->
		<script src='fullcalendar/lib/jquery.min.js'></script>
		<script src='fullcalendar/lib/jquery-ui.min.js'></script>
		<link rel="stylesheet" href="fullcalendar/lib/jquery-ui.min.css">
		<!-- Full Calendar -->
		<link href='fullcalendar/fullcalendar.css' rel='stylesheet' />
		<link href='fullcalendar/fullcalendar.print.css' rel='stylesheet' media='print' />
		<script src='fullcalendar/lib/moment.min.js'></script>
		<script src='fullcalendar/fullcalendar.js'></script>
		<script>
			
			$(document).ready(function() {
			
				var currStart, currEnd;
						
				var dialog = $( "#dialog-form" ).dialog({
					autoOpen: false,
					height: 300,
					width: 350,
					modal: true,
					buttons: {
						"OK": function() {
							submitCalls(currStart, currEnd);
							dialog.dialog( "close" );
						},
						Cancel: function() {
							dialog.dialog( "close" );
						}
					}
				});
		 
				function updateTips( t ) {
					tips
						.text( t )
						.addClass( "ui-state-highlight" );
					setTimeout(function() {
						tips.removeClass( "ui-state-highlight", 1500 );
					}, 500 );
				}
		 
				function checkFilled( o, n) {
				  if ( o.val().length <= 0 ) {
					o.addClass( "ui-state-error" );
					updateTips( n + " is required.");
					return false;
				  } else {
					return true;
				  }
				}
				
				function submitCalls(start, end){
					var eventData,
					title = "",
					faculty = $( "#faculty" ),
					fellow = $( "#fellow" ),
					rn1 = $( "#rn1" ),
					rn2 = $( "#rn2" ),
					tech1 = $( "#tech1" ),
					tech2 = $( "#tech2" );
					
					if (checkFilled(faculty, "faculty") && checkFilled(fellow, "fellow")) {
						eventData = {
							title: title,
							faculty: faculty.val(),
							fellow: fellow.val(),
							rn1: rn1.val(),
							rn2: rn2.val(),
							tech1: tech1.val(),
							tech2: tech2.val(),
							start: start,
							end: end,
												allDay: true
						};
						$('#calendar').fullCalendar('renderEvent', eventData, true); // stick? = true
					}
					//$('#calendar').fullCalendar('unselect');
				}
				
				function selectFunction(start, end) {
					
					currStart = start;
					currEnd = end;
					dialog.dialog( "open" );
				}
				
				$('#calendar').fullCalendar({
					allDaySlot: true,
					//allDayDefault: true,
					header: {
						left: 'alert prev,next today',
						center: 'title',
						right: 'month,agendaDay'
					},
					minTime: "17:00:00",
					maxTime: "29:00:00",
					slotEventOverlap: false,
					
					selectable: true,
					selectHelper: true,
					select: function(start, end){
						selectFunction(start, end);
					},
					editable: true,
					eventLimit: true, // allow "more" link when too many events
					eventClick: function(calEvent, jsEvent, view) {

						alert('Faculty: ' + calEvent.faculty + '\n'
							+ 'Fellow: ' + calEvent.fellow + '\n'
							+ 'RN 1: ' + calEvent.rn1 + '\n'
							+ 'RN 2: ' + calEvent.rn2 + '\n'
							+ 'Tech 1: ' + calEvent.tech1 + '\n'
							+ 'Tech 2: ' + calEvent.tech2);

					},
					events: [
						//todo: fill from database
					]
				});
			});

		</script>
		<style>

			#calendar {
				max-width: 900px;
				margin: 0 auto;
			}
			
			.validateTips { border: 1px solid transparent; padding: 0.3em; }

		</style>
	</head>
	<body>
		<nav class="navbar navbar-default" role="navigation">
		  <div class="container">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
			  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			  </button>
			  <a class="navbar-brand" href="#">FailSafe</a>
			</div>

			<!-- Collect the nav links, forms, and other content for toggling -->
		    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		      <ul class="nav navbar-nav">
		        <li><a href="user_group.html">Directory</a></li>
		        <li><a href="calendar.html">Calendar</a></li>
		      </ul>
		      <form class="navbar-form navbar-left" role="search">
		        <div class="form-group">
		          <input type="text" class="form-control" placeholder="Search">
		        </div>
		        <button type="submit" class="btn btn-default">Submit</button>
		      </form>
		      <ul class="nav navbar-nav navbar-right">
				<li class="dropdown">
		          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Preferences<span class="caret"></span></a>
		          <ul class="dropdown-menu" role="menu">
		            <li><a href="#">Action</a></li>
		            <li><a href="#">Another action</a></li>
		            <li><a href="#">Something else here</a></li>
		            <li class="divider"></li>
		            <li><a href="#">Separated link</a></li>
		          </ul>
		        </li>
		        <li><a href="#">Login</a></li>
		      </ul>
		    </div><!-- /.navbar-collapse -->
		  </div><!-- /.container-fluid -->
		</nav>

		<div id='calendar'></div>
		
		<div id="dialog-form" title="Create new user">
		  <p class="validateTips">All form fields are required.</p>
		 
		  <form>
			<fieldset>
				<div>
					<label for="faculty">Faculty</label>
					<input type="text" name="faculty" id="faculty" class="text ui-widget-content ui-corner-all">
				</div>
				<div>
					<label for="fellow">Fellow</label>
					<input type="text" name="fellow" id="fellow" class="text ui-widget-content ui-corner-all">
				</div>
				<div>
					<label for="rn1">RN 1</label>
					<input type="text" name="rn1" id="rn1" class="text ui-widget-content ui-corner-all">
				</div>
				<div>
					<label for="rn2">RN 2</label>
					<input type="text" name="rn2" id="rn2" class="text ui-widget-content ui-corner-all">
				</div>
				<div>
					<label for="tech1">Tech 1</label>
					<input type="text" name="tech1" id="tech1" class="text ui-widget-content ui-corner-all">
				</div>
				<div>
					<label for="tech2">Tech 2</label>
					<input type="text" name="tech2" id="tech2" class="text ui-widget-content ui-corner-all">
				</div>
		 
			  <!-- Allow form submission with keyboard without duplicating the dialog button -->
			  <input type="submit" tabindex="-1" style="position:absolute; top:-1000px">
			</fieldset>
		  </form>
		</div>
	</body>
</html>
